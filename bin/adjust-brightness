#!/usr/bin/env nu

let backlight_path = "/sys/class/backlight/intel_backlight/brightness"
let max_val = 120000
let min_val = 1000
let change_step = 10000
let large_step = 10000
let small_step = 1000

let current_val = $backlight_path | open | into int

def set_value [new_value] {
  if ($new_value <= $max_val and $new_value >= $min_val) {
    $new_value | save -f $backlight_path
  }
}

def "main +" [] {
  if ($current_val >= $max_val) {
    return 0
  }
  let step = if ($current_val >= $change_step) { $large_step } else { $small_step }
  set_value ($current_val + $step)
}

def "main -" [] {
  if ($current_val <= $min_val) {
    return 0
  }
  let step = if ($current_val <= $change_step) { $small_step } else { $large_step }
  set_value ($current_val - $step)
}

def main [value] {
  set_value value
}
